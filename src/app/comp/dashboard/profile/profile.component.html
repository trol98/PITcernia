<main class="d-flex flex-column align-items-center justify-content-center">
  <div class="text-center">
    <form [formGroup]="accountForm" (ngSubmit)="credentailsChange()">
      <div class="form-row mb-3">
        <mat-form-field>
          <mat-label>Name</mat-label>
          <input matInput formControlName="login" />
        </mat-form-field>
      </div>
      <div class="form-row mb-3">
        <mat-form-field>
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" />
          <mat-error *ngIf="credentailsErrorHandling('email', 'email')">
            You must provide a <strong>valid</strong> email
          </mat-error>
          <mat-error *ngIf="credentailsErrorHandling('email', 'minlength')">
            You must provide a <strong>longer</strong> email
          </mat-error>
        </mat-form-field>
      </div>
      <div class="form-row mb-3">
        <mat-form-field>
          <mat-label>Shipping Address</mat-label>
          <input matInput formControlName="shipping_address" />
        </mat-form-field>
      </div>
      <button
        mat-raised-button
        color="warn"
        type="submit"
        [disabled]="accountForm.invalid"
      >
        Change
      </button>
    </form>
    <hr />
  </div>

  <div class="text-center">
    <form [formGroup]="passwordForm" (ngSubmit)="passwordChange()">
      <div class="form-row mb-3">
        <mat-form-field>
          <mat-label>Old password</mat-label>
          <input
            matInput
            formControlName="oldPassword"
            required
            [type]="hideOldPass ? 'text' : 'password'"
          />
          <button
            type="button"
            mat-icon-button
            matSuffix
            (click)="hideOldPass = !hideOldPass"
            [attr.aria-label]="'Hide password'"
            [attr.aria-pressed]="hideOldPass"
          >
            <mat-icon>{{
              hideOldPass ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>
          <mat-error *ngIf="errorHandling('oldPassword', 'required')">
            You must provide a <strong>password</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div formGroupName="newPassword">
        <div class="form-row mb-3">
          <mat-form-field>
            <mat-label>Password</mat-label>
            <input
              matInput
              formControlName="password"
              required
              [type]="hidePass ? 'text' : 'password'"
            />
            <button
              type="button"
              mat-icon-button
              matSuffix
              (click)="hidePass = !hidePass"
              [attr.aria-label]="'Hide password'"
              [attr.aria-pressed]="hidePass"
            >
              <mat-icon>{{
                hidePass ? "visibility_off" : "visibility"
              }}</mat-icon>
            </button>
            <mat-error *ngIf="nestedErrorHandling('password', 'required')">
              You must provide a <strong>password</strong>
            </mat-error>
            <mat-error
              class="password-mismatch"
              *ngIf="nestedErrorHandling('password', 'mismatch')"
            >
              Passwords don't <strong>match</strong>
            </mat-error>
          </mat-form-field>
        </div>
        <div class="form-row mb-3">
          <mat-form-field>
            <mat-label>Confirm password</mat-label>
            <input
              matInput
              formControlName="confirmPassword"
              required
              [type]="hideConfPass ? 'text' : 'password'"
            />
            <button
              mat-icon-button
              type="button"
              matSuffix
              (click)="hideConfPass = !hideConfPass"
              [attr.aria-label]="'Hide password'"
              [attr.aria-pressed]="hideConfPass"
            >
              <mat-icon>{{
                hideConfPass ? "visibility_off" : "visibility"
              }}</mat-icon>
            </button>
            <mat-error
              *ngIf="nestedErrorHandling('confirmPassword', 'required')"
            >
              You must provide a <strong>password</strong>
            </mat-error>
            <mat-error
              class="password-mismatch"
              *ngIf="nestedErrorHandling('confirmPassword', 'mismatch')"
            >
              Passwords don't <strong>match</strong>
            </mat-error>
          </mat-form-field>
        </div>
      </div>
      <button
        mat-raised-button
        color="warn"
        type="submit"
        [disabled]="passwordForm.invalid"
      >
        Reset
      </button>
    </form>
    <hr />
  </div>
  <div>
    <div class="card bg-danger mb-3">
      <div class="card-header"><p>Delete account</p></div>
      <div class="card-body text-center">
        <h5 class="card-title">
          If all your orders are finished you can delete your account
        </h5>
        <button class="btn btn-dark" (click)="deleteAccount()">Delete</button>
      </div>
    </div>
  </div>
</main>
